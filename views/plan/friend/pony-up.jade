extends layout
block plan-section
	section#section-pony-up.friend-pony-up-section.pony-up-section.plan-section.container-fluid.hide(ng-controller="FriendPonyUpCtrl")
		.row.visible-xs.visible-sm
			.col-xs-12.event-info-container
				include ../includes/event-info
		.header.row
			.col-xs-12
				h1.segoe Pony Up!
		.body
			.row
				.col-md-7.col-xs-12(ng-show="displaySendPonyUp")
					.row
						.col-xs-12
							.security-message
								.header.clearfix
									i.fa.fa-lock.pull-left
									.pull-left Your security is our highest priority!
								.message
									span Wembli uses the latest security technology and has the ultimate safeguards in place to keep your information safe.  We never store bank account information on our servers. Please read our&nbsp;
									a(target="_blank",href="/terms-policies") Terms Of Use &amp; Privacy Policy&nbsp;
									span for more information about how we protect your security on the internet.
					.row
						.col-xs-12
							.header
								i.fa.fa-lock.fa-2x.pull-left
								h3 Secure Credit Card Payment

					.row(ng-show="error")
						.col-xs-12
							.pony-up-alert.alert.alert-warning.clearfix
								i.fa.fa-exclamation-triangle.fa-2x
								span.text {{errorMessage}}
					.row(ng-show="formError")
						.col-xs-12
							.pony-up-alert.alert.alert-warning.clearfix
								i.fa.fa-exclamation-triangle.fa-2x
								span.text Please make sure you've supplied a valid amount for the pony up.

					.row(ng-show="success")
						.col-xs-12
							.pony-up-alert.alert.alert-success.clearfix
								i.fa.fa-check-circle-o.fa-2x.pull-left.green
								.text.pull-left.one-line Woohoo! We successfully sent your pony up.

					.row(ng-show="success")
						.col-xs-12
							a.btn.btn-primary.btn-lg.send-pony-up-button.form-control(href="/plan/itinerary",ng-show="success")
								span &nbsp;View Itinerary

					form.send-pony-up-form(ng-submit="sendPonyUp()", ng-hide="success")
						.row
							.col-md-7.col-xs-12
								.row
									.col-xs-12
										fieldset
											.row.amount-to-pony-up
												.col-xs-8
													.header Amount:&nbsp;
												.col-xs-4.text-right
													strong.amount {{ponyUp.total/100 | currency}}
											.row.form-group
												.col-xs-12
													label Card Holder Name:
													input.form-control(type="text", name="card_holder_name", ng-model="ponyUp.cardHolderName", placeholder="Card Holder Name", required,ng-disabled="success")
											.row.form-group
												.col-xs-12
													label Credit Card Number:
													input.form-control(type="text", name="credit_card_number", ng-model="ponyUp.creditCardNumber", placeholder="Credit Card Number", required,ng-disabled="success")
											.row.form-group
												.col-xs-6
													label Month:
													select.month.form-control(ng-model="ponyUp.expirationDateMonth", name="expiration_date_month", required,ng-disabled="success")
														option(value="01") Jan
														option(value="02") Feb
														option(value="03") Mar
														option(value="04") Apr
														option(value="05") May
														option(value="06") Jun
														option(value="07") Jul
														option(value="08") Aug
														option(value="09") Sep
														option(value="10") Oct
														option(value="11") Nov
														option(value="12") Dec
												.col-xs-6
													label Year:
													select.year.form-control(ng-model="ponyUp.expirationDateYear", name="expiration_date_year", required,ng-disabled="success")
														option(value="2013") 2013
														option(value="2014") 2014
														option(value="2015") 2015
														option(value="2016") 2016
														option(value="2017") 2017
														option(value="2018") 2018
														option(value="2019") 2019
														option(value="2020") 2020
											.row.form-group
												.col-xs-12
													label Security Code:
													input.form-control(type="text", name="cvv", ng-model="ponyUp.cvv", placeholder="Security Code", required,ng-disabled="success")
											.row.form-group
												.col-xs-12
													label Postal Code:
													input.form-control(type="text", name="postal_code", ng-model="ponyUp.postalCode", placeholder="Postal Code", required,ng-disabled="success")

							.col-md-5.col-xs-12
								.secure-codes
									img.img-responsive.center-block(src="/images/security-codes.png")
								.positive-ssl
									img.img-responsive.center-block(src="/images/PositiveSSL.gif")
								.balanced-credit-card-logos
									img.img-responsive(src="/images/balanced-credit-card-logos.png")
						.row
							.col-md-7.col-xs-12
								.send-pony-up-button-container.form-group(ng-hide="success")
									button.btn.btn-warning.btn-lg.send-pony-up-button.form-control(type="submit",ng-hide="sendPonyUpInProgress")
										i.fa.fa-money
										span &nbsp;Send Pony Up!
									button.btn.btn-warning.btn-lg.send-pony-up-button.form-control(ng-show="sendPonyUpInProgress", disabled)
										i.fa.fa-cog.fa-spin
										span &nbsp;Send Pony Up!
							.col-md-5.col-xs-12
								a.btn.btn-danger.btn-lg.send-pony-up-button.form-control(href="#", ng-click="displaySendPonyUp=false", ng-hide="sendPonyUpInProgress")
									span &nbsp;Cancel
								a.btn.btn-danger.btn-lg.send-pony-up-button.form-control(ng-show="sendPonyUpInProgress", disabled)
									span &nbsp;Cancel

				.col-md-7.col-xs-12(ng-hide="displaySendPonyUp")
					h4 Wembli's Pony Up feature allows you to pay back the organizer.  Your plan organizer will send you a Pony Up request telling you how much you owe.  You decide how much you want to send then click Send Pony Up to use your credit card to complete the transaction.
					.notification-container.row
						.col-xs-12

					.pony-up(ng-hide="me.payment[0]")
						.row
							.col-xs-12
								h3 Find Out What It Means To Pony Up
						.row
							.col-xs-12
								p So you're interested to hear all about the Pony Up process?  I like your style.  Here's how this process goes down:
						.row
							.col-xs-12
								p 1. RSVP and submit your votes for the event first (the quicker the better).
						.row
							.col-xs-12
								p 2. When the RSVP due date comes around your organizer will pick tickets, parking, restaurants and hotel based on everyone's votes.
						.row
							.col-xs-12
								p 3. Before your organizer shells out any cash, you'll get a Pony Up Request email to pitch in your share for your tickets and chosen add-ons.
						.row
							.col-xs-12
								.plan-section-note
									strong **NOTE:&nbsp;
									span &nbsp;You'll have 24 hrs from the time you get your pony up email to deposit your share because tickets can't be put on hold.

					.pony-up(ng-show="me.payment[0]")
						.row
							.col-xs-12
								h3 It's Time To Pony Up For Your Part Of The Bill
						.row
							.col-xs-12
								.invitees-container
									.invitee(id="{{me._id}}")
										.row
											.invitee-info.col-xs-12
												//- this is the checkbox and invitee name
												.row
													.col-xs-12
														.invitee-name
															span.name.orange {{me.contactInfo.name}}&nbsp;
															span.guests(ng-show="me.rsvp.decision") + {{me.rsvp.guestCount}} {{me.rsvp.guestCount | pluralize:'guest'}}

												.row.suggested-amounts-container
													.col-xs-8
														.suggested-amount-header Requested Amount:
													.col-xs-4.text-right
														strong.suggested-amount-value {{ponyUp.amountFormatted}}

												.row.send-pony-up-control
													.col-xs-12.col-md-8.send-pony-up-header How Much Will You Pony Up?
													.col-xs-12.col-md-4
														.form-group
															.input-group.text-right(ng-class="{true:'muted'}[friend.ponyUp.open]")
																span.input-group-addon $
																input.pony-up-amount.form-control(type="text",ng-model="ponyUp.amountFormatted")

												.row.suggested-amounts-container
													.col-xs-12
														.row.suggested-amounts-trigger.transaction-fee-trigger(ng-click="showFees=!showFees")
															.col-xs-8.clearfix
																i.fa.fa-caret-right.suggested-amounts-caret.fa-2x.rotate-right-90.pull-left(ng-class="{'rotate-right':showFees}")
																.suggested-amount-header.pull-left Wembli Pony Up Transaction Cost:
															.col-xs-4.text-right
																strong.suggested-amount-value {{ponyUp.transactionFee/100 | currency}}

														.row.transaction-fee.slide-down(ng-show="showFees")
															.col-xs-12
																span Hey - we gotta keep the lights on and the servers running somehow?!
																br
																span Wembli charges $2.50 plus 2.9% of the amount you pony up.

														.row
															.col-xs-8
																.suggested-amount-header TOTAL AMOUNT TO BE CHARGED:
															.col-xs-4.text-right
																strong.suggested-amount-value {{ponyUp.total/100 | currency}}


												.row.history-container
													.col-xs-12
															.row
																.col-xs-12.history-trigger(ng-click="showHistory=!showHistory")
																	.history-header
																		span HISTORY&nbsp;
																		span(ng-hide="showHistory") (click to expand)

															.row.history.slide-down(ng-show="showHistory")
																.col-xs-12
																	.row.history-item(ng-repeat="history in me.payment | orderBy:'-date'")
																		.col-xs-12
																			.divider
																		.col-xs-12.type(ng-show="{'outside':true}[history.type]") {{history.date | date:'short'}} - Outside Payment Received ({{history.method}})
																		.col-xs-12.type(ng-show="{'request':true}[history.type]") {{history.date | date:'short'}} - Pony Up Requested
																		.col-xs-12.type(ng-show="{'response':true}[history.type]") {{history.date | date:'short'}} - Pony Up Received

																		.col-xs-12
																			.row.history-header-row
																				.col-xs-8.history-header Status
																				.col-xs-4.history-header Amount
																			.row
																				.col-xs-8 {{history.status | historyStatus}}
																				.col-xs-4 {{history.amount/100 | currency}}

																	.row
																		.col-xs-12
																			.border-bottom
																	.row.total-requested
																		.col-xs-8
																			.history-header.text-right Total Requested:
																		.col-xs-4.amount.text-left {{me.payment.requested/100 | currency}}
																	.row.total-paid
																		.col-xs-8.history-header.text-right Total Paid:
																		.col-xs-4.amount.text-left {{me.payment.received/100 | currency}}
																	.row.balance
																		.col-xs-8.history-header.text-right Balance:
																		.col-xs-4.amount.text-left {{me.payment.balance/100 | currency}}

									.row.send-pony-up-button-container
										.col-xs-12
											a.btn.btn-warning.btn-lg.send-pony-up-button.form-control(ng-click="displaySendPonyUp=true", ng-disabled="{false:true}[ponyUpRequest.open] || !ponyUp.amountFormatted", href="#")
												i.fa.fa-money
												span &nbsp;Send Pony Up!


				.col-md-5.col-xs-12.event-info-container
					.hidden-xs.hidden-sm
						include ../includes/event-info

					.row
						.col-xs-12
							.pony-up-alert-info.alert.alert-info
								i.fa.fa-info-circle.fa-2x
								span You can see what has been chosen by viewing the itinerary
					.row
						.col-xs-12
							a.btn.btn-primary.form-control(href="/plan/itinerary") View Itinerary

					//- taking this out for now - don't need to show the friend all the pricing details
						.section-options-container.row
							.col-xs-12
								.row
									.col-xs-12
										h3 Pricing Details:


								.row.suggested-amount.suggested-ticket-amount(ng-show="tickets[0]")
									.col-xs-9
										strong Ticket Price (each):
									.col-xs-3.text-right
										strong.estimated-total {{tickets[0].costBreakdown.price | currency}}
									.col-xs-3.text-right

								.row.suggested-amount.suggested-ticket-amount(ng-show="tickets[0]")
									.col-xs-9
										strong Ticket Broker Fee (each):
									.col-xs-3.text-right
										strong.estimated-total {{tickets[0].costBreakdown.serviceFee | currency}}
									.col-xs-3.text-right

								.row.suggested-amount.suggested-ticket-amount(ng-show="tickets[0]")
									.col-xs-9
										strong SubTotal ({{me.rsvp.guestCount + 1}}x):
									.col-xs-3.text-right
										strong.estimated-total {{tickets[0].costBreakdown.totalEach * (me.rsvp.guestCount + 1) | currency}}
									.col-xs-3.text-right

								.row.suggested-amount.suggested-ticket-amount(ng-show="tickets[0]")
									.col-xs-9
										strong Delivery Fee:
									.col-xs-3.text-right
										strong.estimated-total {{tickets[0].costBreakdown.deliveryFeeEach | currency}}
									.col-xs-3.text-right

								.row.suggested-amount.suggested-ticket-amount(ng-show="tickets[0]")
									.col-xs-9
										strong Total:
									.col-xs-3.text-right
										strong.estimated-total {{tickets[0].costBreakdown.deliveryFeeEach + (tickets[0].costBreakdown.totalEach * (me.rsvp.guestCount + 1)) | currency}}
									.col-xs-3.text-right



								.row.suggested-amount.suggested-parking-amount(ng-show="plan.preferences.addOns.parking")
									.col-xs-9
										strong Parking for {{me.rsvp.guestCount + 1}} {{me.rsvp.guestCount + 1 | pluralize:'person'}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.parking && plan.parking[0]")
										strong.estimated-total {{me.parking.suggestedPonyUpAmount | currency}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.parking && !plan.parking[0]") -

								.row.suggested-amount.suggested-restaurant-amount(ng-show="plan.preferences.addOns.restaurants")
									.col-xs-9
										strong Restaurant for {{me.rsvp.guestCount + 1}} {{me.rsvp.guestCount + 1 | pluralize:'person'}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.restaurants && plan.restaurants[0]")
										strong.estimated-total {{me.restaurants.suggestedPonyUpAmount | currency}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.restaurants && !plan.restaurants[0]") -

								.row.suggested-amount.suggested-hotel-amount(ng-show="plan.preferences.addOns.hotels")
									.col-xs-9
										strong Hotel for {{me.rsvp.guestCount + 1}} {{me.rsvp.guestCount + 1 | pluralize:'person'}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.hotels && plan.hotels[0]")
										strong.estimated-total {{me.hotels.suggestedPonyUpAmount | currency}}
									.col-xs-3.text-right(ng-show="plan.preferences.addOns.hotels && !plan.hotels[0]") -
								.row
									.col-xs-12
										strong.disclaimer * Wembli estimates prices/fees.  Actual prices/fees may vary slighty at time of purchase depending on the provider.

					.row.hidden-sm.hidden-xs
						.col-xs-12
							img.wembliman.img-responsive(src="/images/cartoon-man-money-left.png")


